clear all; clc; close all

f=0:20e3;


%% parameters of the plate
h1=5e-3; % epaisseur de la plaque 1
h2=10e-3; % epaisseur de la plaque 1

E1=2.6e9; %young modulus plaque 1 
E2=2.6e9; %young modulus plaque 2 

rho=7850; % densité plaque
nu=0.245; % coefficient de poisson MDF

mu1= rho*h1; % poid de la plaque 1 
mu2= rho*h2; % poid de la plaque 2

D1= E1*h1^3/(12*(1-nu^2));
D2= E2*h2^3/(12*(1-nu^2));

%% parameters of the air 

e=0.05; % espace entre les cloisons
c0=343; % vitesse de l'air
rho0=1.2;


theta=30*pi/180;

Tau = zeros(length(f),1);

for ii=1:length(f)
omega = f(ii)*2*pi;
k0 = omega/c0;
k = k0 *sind(30);
TH=cosd(30);
alp = exp(+1j*k0*TH*e);
alm = exp(-1j*k0*TH*e);
beta = k0*cos(theta) ;
alpha_1 = exp( 1i * k0 * cos(theta) * e) ;
alpha_2 = exp( -1i * k0 * cos(theta) * e);
%%

A= [ 1j*k0*TH 0 0 0 rho0*omega^2 0; ...
    0 -1j*k0*TH 1j*k0*TH 0 rho0*omega^2 0; ...
    1 -1 -1 0 -mu1*omega^2+D1*k^4 0 ;...
    0 -1j*k0*TH*alm 1j*k0*TH*alp 0 0  rho0*omega^2;...
    0 0 0 -1j*k0*TH*alm 0 rho0*omega^2;...
    0 alm alp -alm 0 -mu2*omega^2+D2*k^4 ...
    ];
B = [1j*k0*TH ; 0 ;-1; 0; 0;0];

s =  A\B;
Tau(ii) = s(4)^2;
end

omega =  2*pi*f;
k0 = omega/c0;

wc1=c0^2/(sind(30)^2)*sqrt(mu1/D1);% fréquence de coincidence
wc2=c0^2/(sind(30)^2)*sqrt(mu2/D2);%

Taus = omega.^2 *(rho0*c0)^2/TH^2*4./abs(-omega.^2*mu+D*k0.^4*sind(30)^4+2*rho0*omega*c0/1j/TH).^2;
semilogx(f,10*log10(1./real(abs(Tau))))
hold on
semilogx(f,10*log10(1./real(Taus)))

xlabel('Frequence [Hz] log')
ylabel('Indice d''affaiblissement 10log_{10}')
legend('Cloison double','Plaque')
xlim([f(1) f(end)])
% fc = wc/2/pi
% fn =1*c0/(2*e*cosd(30))
% fre=1/(2*pi)*sqrt(2*rho0*(c0)^2/(e*mu*cosd(30)^2))